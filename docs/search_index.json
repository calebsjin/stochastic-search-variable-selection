[
["index.html", "Stochastic Search Variable Selection (SSVS) Chapter 1 Prerequisites", " Stochastic Search Variable Selection (SSVS) Shiqiang Jin 4-17-2017 Chapter 1 Prerequisites I am Caleb Jin. This is my note of Stochastic Search Variable Selection (SSVS)(George and McCulloch 1997) and (George and McCulloch 1993). Due to my limited statistics knowledge, if making any mistakes, I sincerely expect you guys can email to me. My email address is jinsq@ksu.edu. Appreicate! References "],
["setup.html", "Chapter 2 Setup", " Chapter 2 Setup Let \\({\\bf D}=({\\bf M},{\\bf y})\\) be a dataset, where \\({\\bf M}\\in \\mathbb{R}^{n\\times p}\\) and \\({\\bf y}\\in \\mathbb{R}^{n}\\) with \\(n=100\\) and \\(p=500\\). We are interested in finding predictors related to the response. Consider a high dimensional linear regression model as follows: \\[\\begin{eqnarray} {\\bf y}={\\bf X}{\\boldsymbol \\beta}+ {\\boldsymbol \\epsilon} \\tag{2.1} \\end{eqnarray}\\] where \\({\\bf y}=(y_1,y_2,\\ldots,y_{n})^{{\\top}}\\) is the \\(n\\)-dimensional response vector, \\({\\bf X}=[1,{\\bf M}]=[{\\bf x}_0, {\\bf x}_1,\\ldots,{\\bf x}_{p}]\\) is the \\(n\\times (p+1)\\) design matrix, and \\({\\boldsymbol \\epsilon}\\sim \\mathcal{N}_{n}({\\bf 0},\\sigma^2{\\bf I}_{n})\\). Note that as \\(p+1&gt;n\\), \\({\\bf X}\\) is not full rank. "],
["stochastic-search-variable-selection-ssvs.html", "Chapter 3 Stochastic Search Variable Selection (SSVS)", " Chapter 3 Stochastic Search Variable Selection (SSVS) From (2.1), the likelihood function is given as \\[ {\\bf y}|{\\boldsymbol \\beta}, \\sigma^2 \\sim \\mathcal{N}({\\bf X}{\\boldsymbol \\beta}, \\sigma^2I_n). \\] We define the prior as follows: \\[ \\beta_j|\\sigma^2,\\gamma_j \\stackrel{ind}{\\sim} (1-\\gamma_j) \\mathcal{N}(0, \\sigma^2\\nu_0) + \\gamma_j\\mathcal{N}(0,\\sigma^2\\nu_1), \\] where \\(\\nu_0\\) and \\(\\nu_1\\) will be chosen to be small and large, respectively. Note that the likelihood is independent of \\({\\boldsymbol \\gamma}=(\\gamma_1,\\ldots,\\gamma_p)\\). Assume \\[ \\sigma^2 \\sim \\mathcal{IG}(\\frac{a}{2}, \\frac{b}{2}), \\] which is also independent of \\({\\boldsymbol \\gamma}\\). We consider \\[ \\gamma_j \\stackrel{iid}{\\sim} Ber(\\omega). \\] To make our model robust to the choice of \\(\\omega\\), we will assign the following prior on \\(\\omega\\). \\[w\\sim \\mathcal{B}(c_1,c_2),\\] where we will use \\(c_1=c_2=1\\), which leads to the uniform distribution. Recall the density function of beta distribution is proportional \\(\\pi(w)\\propto w^{c_1-1}(1-w)^{c_2-1}\\). It is easy to show that the full conditionals are as follows: \\[\\beta_j|{\\boldsymbol \\beta}_{-j}, \\sigma^2, {\\boldsymbol \\gamma}, {\\bf y}\\sim \\mathcal{N}(\\tilde{\\beta}_j, \\frac{\\sigma^2}{\\mu_j}).\\] where \\(\\mu_j= x_j^{{\\top}}x_j + \\frac{1}{\\nu_{\\gamma_j}}\\) and \\(\\tilde{\\beta}_j = \\mu_j^{-1}x_j^{{\\top}}({\\bf y}- {\\bf X}_{-j}{\\boldsymbol \\beta}_{-j})\\). \\[ \\gamma_j |{\\boldsymbol \\gamma}_{-j}, {\\boldsymbol \\beta}, \\sigma^2, {\\bf y}\\sim Ber\\left(\\frac{ \\nu_1^{-\\frac{1}{2}} \\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega} { \\nu_0^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_0}\\beta_j^2\\right)\\left(1-\\omega\\right)+ \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega}\\right). \\] \\[\\sigma^2|{\\boldsymbol \\beta}, {\\boldsymbol \\gamma}, {\\bf y}\\sim \\mathcal{IG}(a^*,b^*),\\] where \\(a^*=\\frac{1}{2}(n+p+a)\\) and \\(b^* = \\frac{1}{2}\\left(\\|{\\bf y}-{\\bf X}{\\boldsymbol \\beta}\\|^2 + \\sum_{j=1}^{p}\\frac{\\beta_j^2}{\\nu_{\\gamma_j}} + b\\right).\\) \\[w|{\\boldsymbol \\beta},{\\boldsymbol \\gamma},\\sigma^2,{\\bf y}\\sim \\mathcal{B}\\left(\\sum_{j=1}^p \\gamma_j+c_1,p-\\sum_{j=1}^p \\gamma_j+c_2\\right).\\] To speed up, we consider the following conditionals: 1’) \\[{\\boldsymbol \\beta}|\\sigma^2, {\\boldsymbol \\gamma}, {\\bf y}\\sim \\mathcal{N}(\\tilde{{\\boldsymbol \\beta}}, {\\sigma^2}({\\bf X}^{\\top}{\\bf X}+{\\bf V}^{-1}_{\\boldsymbol \\gamma})^{-1}),\\] where \\({\\bf V}_{\\boldsymbol \\gamma}={\\rm diag}(v_{\\gamma_j})_{j=0}^p\\) and \\(\\tilde{{\\boldsymbol \\beta}} = ({\\bf X}^{\\top}{\\bf X}+{\\bf V}^{-1}_{\\boldsymbol \\gamma})^{-1}{\\bf X}^{\\top}{\\bf y}\\). 2’) \\[ {\\boldsymbol \\gamma}|{\\boldsymbol \\beta}, \\sigma^2, {\\bf y}\\sim \\prod_{j=0}^p Ber\\left(\\frac{ \\nu_1^{-\\frac{1}{2}} \\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega} { \\nu_0^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_0}\\beta_j^2\\right)\\left(1-\\omega\\right)+ \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega}\\right). \\] 3’) \\[\\sigma^2|{\\boldsymbol \\beta}, {\\boldsymbol \\gamma}, {\\bf y}\\sim \\mathcal{IG}(a^*,b^*).\\] where \\(a^*=\\frac{1}{2}(n+p+a)\\) and \\(b^* = \\frac{1}{2}\\left(\\|{\\bf y}-{\\bf X}{\\boldsymbol \\beta}\\|^2 + \\sum_{j=1}^{p}\\frac{\\beta_j^2}{\\nu_{\\gamma_j}} + b\\right).\\) 4’) \\[w|{\\boldsymbol \\beta},{\\boldsymbol \\gamma},\\sigma^2,{\\bf y}\\sim \\mathcal{B}\\left(\\sum_{j=1}^p \\gamma_j+c_1,p-\\sum_{j=1}^p \\gamma_j+c_2\\right).\\] "],
["simulation-study.html", "Chapter 4 Simulation Study", " Chapter 4 Simulation Study "],
["appendix.html", "Chapter 5 Appendix", " Chapter 5 Appendix For \\(\\beta_j|{\\boldsymbol \\beta}_{-j}, \\sigma^2, {\\boldsymbol \\gamma}, {\\bf y}\\) \\((j = 1,2, \\ldots,p)\\), we have \\[\\begin{eqnarray*} \\pi(\\beta_j|{\\boldsymbol \\beta}_{-j}, \\sigma^2, {\\boldsymbol \\gamma}, {\\bf y})&amp;\\propto&amp;f({\\bf y}|{\\boldsymbol \\beta}, \\sigma^2)\\pi({\\boldsymbol \\beta}|{\\boldsymbol \\gamma}, \\sigma^2)\\\\ &amp;=&amp;f({\\bf y}|{\\boldsymbol \\beta}_{{\\boldsymbol \\gamma}}, \\sigma^2) \\prod_{k=1}^{p}\\pi(\\beta_k|Z_k, \\sigma^2)\\\\ &amp;\\propto&amp;f({\\bf y}|{\\boldsymbol \\beta}, \\sigma^2)\\pi(\\beta_j|\\gamma_j, \\sigma^2)\\\\ &amp;\\propto&amp; \\exp\\left(-\\frac{1}{2\\sigma^2}\\|{\\bf y}-{\\bf X}{\\boldsymbol \\beta}\\|^2 \\right) \\exp\\left(-\\frac{1}{2\\sigma^2\\nu_{\\gamma_j}}\\beta_j^2\\right)\\\\ &amp;=&amp; \\exp\\left(-\\frac{1}{2\\sigma^2}\\|{\\bf y}- {\\bf X}_{-j}{\\boldsymbol \\beta}_{-j} - x_j \\beta_j\\|^2\\right) \\exp\\left(-\\frac{1}{2\\sigma^2\\nu_{\\gamma_j}}\\beta_j^2\\right)\\\\ &amp;=&amp; \\exp\\left(-\\frac{1}{2\\sigma^2}\\|{\\bf y}^* - x_j \\beta_j\\|^2\\right) \\exp\\left(-\\frac{1}{2\\sigma^2\\nu_{\\gamma_j}}\\beta_j^2\\right)\\\\ &amp;=&amp;\\exp\\left[-\\frac{1}{2\\sigma^2}\\left({{\\bf y}^*}^{{\\top}}{\\bf y}^* - 2\\beta_j x_j^{{\\top}}{\\bf y}^* + \\beta_j x_j^{{\\top}}x_j\\beta_j + \\frac{1}{\\nu_{\\gamma_j}}\\beta_j^2\\right)\\right]\\\\ &amp;\\propto&amp;\\exp\\left[-\\frac{1}{2\\sigma^2}\\left(\\beta_j^2(x_j^{{\\top}}x_j + \\frac{1}{\\nu_{\\gamma_j}}) - 2\\beta_j x_j^{{\\top}}{\\bf y}^* \\right)\\right]\\\\ &amp;=&amp;\\exp\\left[-\\frac{1}{2\\sigma^2}\\left(\\beta_j^2(x_j^{{\\top}}x_j + \\frac{1}{\\nu_{\\gamma_j}}) - 2\\beta_j (x_j^{{\\top}}x_j + \\frac{1}{\\nu_{\\gamma_j}})(x_j^{{\\top}}x_j + \\frac{1}{\\nu_{\\gamma_j}})^{-1} x_j^{{\\top}}{\\bf y}^* \\right)\\right]\\\\ &amp;=&amp; \\exp\\left[-\\frac{a}{2\\sigma^2}\\left(\\beta_j^2 - 2a \\beta_j \\tilde \\beta_j\\right)\\right]\\\\ &amp;\\propto&amp; \\exp\\left[-\\frac{a}{2\\sigma^2}\\left(\\beta_j -\\tilde \\beta_j\\right)^2\\right]\\\\ \\end{eqnarray*}\\] where \\({\\bf y}^* = {\\bf y}- {\\bf X}_{-j}{\\boldsymbol \\beta}_{-j}, \\quad \\mu_j= x_j^{{\\top}}x_j + \\frac{1}{\\nu_{\\gamma_j}},\\quad \\tilde \\beta_j = \\mu_j^{-1}x_j^{{\\top}}{\\bf y}^*\\). Hence, \\[\\beta_j|{\\boldsymbol \\beta}_{-j}, \\sigma^2, {\\boldsymbol \\gamma}, {\\bf y}\\sim \\mathcal{N}(\\tilde \\beta_j, \\frac{\\sigma^2}{\\mu_j}).\\] For \\(\\pi(\\gamma_j|{\\boldsymbol \\gamma}_{-j}, {\\boldsymbol \\beta}, \\sigma^2, {\\bf y})\\) \\((j = 1,2, \\ldots,p)\\) we have \\[\\begin{eqnarray*} \\pi(\\gamma_j|{\\boldsymbol \\gamma}_{-j}, {\\boldsymbol \\beta}, \\sigma^2, {\\bf y})&amp;\\propto&amp; \\pi({\\boldsymbol \\gamma},{\\boldsymbol \\beta}|\\sigma^2)\\\\ &amp;=&amp;\\pi({\\boldsymbol \\beta}|\\sigma^2, {\\boldsymbol \\gamma})\\pi({\\boldsymbol \\gamma})\\\\ &amp;=&amp; \\prod_{k=1}^{p}\\pi(\\beta_{k}|\\sigma^2, z_{k})\\prod_{i=1}^{p}\\pi(z_i)\\\\ &amp;\\propto&amp;\\pi(\\beta_{j}|\\sigma^2, z_{j})\\pi(\\gamma_j)\\\\ &amp;\\propto&amp;\\nu_{\\gamma_j}^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_{\\gamma_j}}\\beta_j^2\\right)\\omega^{\\gamma_j} (1-\\omega)^{1-\\gamma_j}. \\end{eqnarray*}\\] Note that \\[\\begin{eqnarray*} \\pi(\\gamma_j = 0|{\\boldsymbol \\gamma}_{-j}, {\\boldsymbol \\beta}, \\sigma^2, {\\bf y})&amp;=&amp; C \\nu_0^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_0}\\beta_j^2\\right)\\left(1-\\omega\\right);\\\\ \\pi(\\gamma_j = 1|{\\boldsymbol \\gamma}_{-j}, {\\boldsymbol \\beta}, \\sigma^2, {\\bf y})&amp;=&amp; C \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega. \\end{eqnarray*}\\] This implies that \\[\\begin{eqnarray*} \\pi(\\gamma_j = 1|{\\boldsymbol \\gamma}_{-j}, {\\boldsymbol \\beta}, \\sigma^2, {\\bf y}) &amp;=&amp;\\frac{P(\\gamma_j = 1,\\Omega)}{\\sum_{\\gamma_j}P(\\gamma_j,\\Omega)}\\\\ &amp;=&amp; \\frac{C \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega} { C \\nu_0^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_0}\\beta_j^2\\right)\\left(1-\\omega\\right)+ C \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega}\\\\ &amp;=&amp; \\frac{ \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega} { \\nu_0^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_0}\\beta_j^2\\right)\\left(1-\\omega\\right)+ \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega}. \\end{eqnarray*}\\] Hence, \\[ \\gamma_j |{\\boldsymbol \\gamma}_{-j}, {\\boldsymbol \\beta}, \\sigma^2, {\\bf y}\\sim Ber\\left(\\frac{ \\nu_1^{-\\frac{1}{2}} \\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega} { \\nu_0^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_0}\\beta_j^2\\right)\\left(1-\\omega\\right)+ \\nu_1^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_1}\\beta_j^2\\right)\\omega}\\right). \\] For \\(\\sigma^2|{\\boldsymbol \\beta}, {\\boldsymbol \\gamma}, {\\bf y}\\), we have \\[\\begin{eqnarray*} \\pi(\\sigma^2|{\\boldsymbol \\beta}, {\\boldsymbol \\gamma}, {\\bf y})&amp;\\propto&amp;f({\\bf y}|{\\boldsymbol \\beta},\\sigma^2,{\\boldsymbol \\gamma})\\pi({\\boldsymbol \\beta},\\sigma^2|{\\boldsymbol \\gamma})\\\\ &amp;=&amp;f({\\bf y}|{\\boldsymbol \\beta}, \\sigma^2, {\\boldsymbol \\gamma})\\pi({\\boldsymbol \\beta}|\\sigma^2,{\\boldsymbol \\gamma})\\pi(\\sigma^2|{\\boldsymbol \\gamma})\\\\ &amp;=&amp;f({\\bf y}|{\\boldsymbol \\beta}, \\sigma^2)\\pi({\\boldsymbol \\beta}|\\sigma^2,{\\boldsymbol \\gamma})\\pi(\\sigma^2)\\\\ &amp;\\propto&amp;(\\sigma^2)^{-\\frac{n}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2}\\|{\\bf y}-{\\bf X}{\\boldsymbol \\beta}\\|^2\\right)\\times \\prod_{j=1}^{p}\\left[(\\sigma^2\\nu_{\\gamma_j})^{-\\frac{1}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2\\nu_{\\gamma_j}} \\beta_j^2\\right)\\right]\\\\ &amp;&amp;\\times(\\sigma^2)^{-\\frac{a}{2}-1}\\exp\\left(-\\frac{b}{2\\sigma^2}\\right)\\\\ &amp;\\propto&amp;(\\sigma^2)^{-\\frac{n}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2}\\|{\\bf y}-{\\bf X}{\\boldsymbol \\beta}\\|^2\\right)\\times (\\sigma^2)^{-\\frac{p}{2}}\\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{j=1}^{p}\\frac{\\beta_j^2}{\\nu_{\\gamma_j}}\\right)\\\\ &amp;&amp;\\times(\\sigma^2)^{-\\frac{a}{2}-1}\\exp\\left(-\\frac{b}{2\\sigma^2}\\right)\\\\ &amp;=&amp; (\\sigma^2)^{-\\frac{1}{2}(n+p+a)-1}\\exp\\left(-\\frac{\\frac{1}{2}\\left(\\|{\\bf y}-{\\bf X}{\\boldsymbol \\beta} \\|^2 + \\sum_{j=1}^{p}\\frac{\\beta_j^2}{\\nu_{\\gamma_j}} + b\\right)}{\\sigma^2}\\right)\\\\ &amp;=&amp;(\\sigma^2)^{-a^* -1}\\exp(-\\frac{b^*}{\\sigma^2}), \\end{eqnarray*}\\] where \\(a^*=\\frac{1}{2}(n+p+a)\\) and \\(b^* = \\frac{1}{2}\\left(\\|{\\bf y}-{\\bf X}{\\boldsymbol \\beta}\\|^2 + \\sum_{j=1}^{p}\\frac{\\beta_j^2}{\\nu_{\\gamma_j}} + b\\right).\\) Therefore, \\[\\sigma^2|{\\boldsymbol \\beta}, {\\boldsymbol \\gamma}, {\\bf y}\\sim \\mathcal{IG}(a^*,b^*).\\] For \\(w|{\\boldsymbol \\beta},{\\boldsymbol \\gamma},\\sigma^2,{\\bf y}\\), we have \\[\\begin{eqnarray*} \\pi(w|{\\boldsymbol \\beta},{\\boldsymbol \\gamma},\\sigma^2,{\\bf y})&amp;\\propto&amp; \\pi({\\boldsymbol \\gamma}|w) \\pi(w)\\\\ &amp;\\propto&amp;\\left[ \\prod_{j=1}^p w^{\\gamma_j}(1-w)^{1-\\gamma_j}\\right] w^{c_1-1}(1-w)^{c_2-1}\\\\ &amp;\\propto&amp; w^{\\sum_{j=1}^p \\gamma_j+c_1-1}(1-w)^{p-\\sum_{j=1}^p \\gamma_j+c_2-1}. \\end{eqnarray*}\\] We therefore have \\[w|{\\boldsymbol \\beta},{\\boldsymbol \\gamma},\\sigma^2,{\\bf y}\\sim \\mathcal{B}\\left(\\sum_{j=1}^p \\gamma_j+c_1,p-\\sum_{j=1}^p \\gamma_j+c_2\\right).\\] "],
["references.html", "References", " References "]
]
